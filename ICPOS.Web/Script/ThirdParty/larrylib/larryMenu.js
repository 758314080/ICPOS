layui.define(["jquery","layer","common","element"],function(a){var t=layui.$,e=layui.layer,i=layui.common,r=layui.element;var n=function(){this.config={name:"",offsetX:2,offsetY:2,textLimit:16,beforeShow:t.noop,afterShow:t.noop};this.params="";this._data=""};var s=t(document).data("func",{});var o=t("body");n.prototype.ContentMenu=function(a,e,i){var r=this;r._data=a;r.params=t.extend(true,r.config,e||{});i.each(function(){this.oncontextmenu=function(a){if(t.isFunction(r.params.beforeShow)){r.params.beforeShow.call(this)}a=a||window.event;a.cancelBubble=true;if(a.stopPropagation){a.stopPropagation()}r.hide();var e=s.scrollTop();var i=r.funLarryMenu(r._data);if(i){var n,o;var l=t(window).width();var c=t(window).height();var f=t("div.larryMenuBox").width();var d=t("div.larryMenuBox").height();if(l<a.clientX+r.params.offsetX+f){n=a.clientX-r.params.offsetX-f;i.find("ul li").children("div.larryMenuBox").css({top:"-35px",left:-(f+2)})}else{n=a.clientX+r.params.offsetX;i.find("ul li").children("div.larryMenuBox").css({top:"-1px",left:f-5})}if(c<a.clientY+r.params.offsetY+d){o=a.clientY-r.params.offsetY-d}else{o=a.clientY+e+r.params.offsetY}i.css({display:"block",left:n,top:o});s.data("target",i);s.data("trigger",this);if(t.isFunction(r.params.afterShow)){r.params.afterShow.call(this)}return false}}});if(!o.data("bind")){o.bind("click",r.hide).data("bind",true)}};n.prototype.htmlCreateMenu=function(a){var e=this;var i=a||e._data,r=a?Math.random().toString():e.params.name,n="",o="",l="larry_menu_";if(t.isArray(i)&&i.length){n='<div id="larryMenu_'+r+'" class="'+l+'box larryMenuBox">'+'<div class="'+l+'body">'+'<ul class="'+l+'ul">';t.each(i,function(a,i){if(a){n+='<li class="'+l+'li_separate">&nbsp;</li>'}if(t.isArray(i)){t.each(i,function(a,i){var r=i.text,o="",c="",f=Math.random().toString().replace(".","");if(r){if(r.length>e.params.textLimit){r=r.slice(0,e.params.textLimit)+"â€¦";c=' title="'+i.text+'"'}if(t.isArray(i.data)&&i.data.length){o='<li class="'+l+'li" data-hover="true">'+e.htmlCreateMenu(i.data)+'<a href="javascript:" class="'+l+'a"'+c+' data-key="'+f+'"><i class="'+l+'triangle"></i>'+r+"</a>"+"</li>"}else{o='<li class="'+l+'li">'+'<a href="javascript:" class="'+l+'a"'+c+' data-key="'+f+'">'+r+"</a>"+"</li>"}n+=o;var d=s.data("func");d[f]=i.func;s.data("func",d)}})}});n+="</ul>"+"</div>"+"</div>"}return n};n.prototype.funLarryMenu=function(){var a=this;var e="#larryMenu_",i="larry_menu_",r=t(e+a.params.name);if(!r.size()){t("body").append(a.htmlCreateMenu());t(e+a.params.name+" a").bind("click",function(){var e=t(this).attr("data-key"),i=s.data("func")[e];if(t.isFunction(i)){i.call(s.data("trigger"))}a.hide();return false});t(e+a.params.name+" li").each(function(){var a=t(this).attr("data-hover"),e=i+"li_hover";t(this).hover(function(){var r=t(this).siblings("."+e);r.removeClass(e).children("."+i+"box").hide();r.children("."+i+"a").removeClass(i+"a_hover");if(a){t(this).addClass(e).children("."+i+"box").show();t(this).children("."+i+"a").addClass(i+"a_hover")}})});return t(e+a.params.name)}return r};n.prototype.hide=function(){var a=s.data("target");if(a&&a.css("display")==="block"){a.hide()}};n.prototype.remove=function(){var a=s.data("target");if(a){a.remove()}};var l=new n;a("larryMenu",function(){return l})});